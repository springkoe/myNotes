# Linux OS

## 1. 基础概念

### 1.1 操作系统(OS)

* 定义
  **操作系统是管理计算机硬件和软件资源的计算机程序**，同时也是计算机系统的内核与基石。负责管理和配置内存，决定系统资源供需的优先顺序、控制输入输出设备、操作网络与管理文件系统等基本事物。

* 操作系统分类
>1. 桌面系统：Windows、MacOS为主，图形化界面良好，用户群体大
>2. 服务器系统：Linux、Unix为主，安全稳定，费用低占有量大
>3. 嵌入式系统：Linux为主，主要用于小型智能设备

### 1.2 Linux系统介绍
* Linux系统特点

>1. Linux是一款开源免费的操作系统
>2. 支持多种硬件平台
>3. 支持多用户，多任务
>4. 具有非常强大的网络功能
* Linux应用领域
>1. Linux服务器：目前是服务器系统中最广泛的一种
>2. 桌面应用
>3. 嵌入式系统
* Linux系统构成
>1. 内核：Linux操作系统的核心代码，提供系统核心功能，用来软硬件交互
>2. **文件系统**：通常指称管理磁盘数据的系统，可将数据以目录或文件的形式储存
>3. **命令解释器**：它使得用户能够与操作系统进行交互
>4. 应用软件：包含桌面系统和基础的软件操作工具等
### 1.3 文件系统

> 1. Linux的文件组织中没有盘符。将根"/"作为整个文件系统的唯一起点，其他所有目录都从该点出发，像一颗倒立的树
> 2. 绝对路径：以根作为目录起始位置，如/home/tarena/桌面/pysrc/t2/day01/demo
> 3. 相对路径：以当前位置作为起始位置，如../day01/demo（假设当前在t2/day02/目录下

## 2. Linux常用命令

### 2.1 终端快捷键

| 快捷键     | 作用             |
| ---------- | ---------------- |
| ctrl alt t | 打开终端         |
| ctrl d     | 关闭终端         |
| ctrl c     | 中断当前终端任务 |
| ctrl l     | 清空终端信息(伪) |
| up/down    | 调取历史命令     |

### 2.2 Linux常用命令

* 2.2.1 帮助命令
```shell
$ man 命令
```
#### 2.2.2 基础操作命令

| 序号| 命令| 作用|英文|
|:---: |:------|:-------|:----|
| 01 | ls |查看当前文件夹下内容-a表示显示隐藏文件，-l表示显示详细信息| **l**ist|
| 02 | pwd |查看当前位置绝对路径| **p**rint **w**ork **d**irectory|
| 03 | cd[目录名]|切换文件夹，后面参数不写默认~位置|**c**hange **d**irectory|
| 04| touch[文件名]|若文件不存在，新建文件，否则更新文件日期|**t**ouch|
| 05 | mkdir[文件夹名]|创建目录|**m**a**k** **dir**ectory|
| 06 | rm[文件名]|删除指定的文件名|**r**e**m**ove|
| 07 | cp |复制一个文件|**c**opy|
| 08 | mv|移动一个文件|**m**o**v**e|

* **cd** 细节说明
```shell
# 切换到用户主目录
$ cd
# 切换到绝对路径目录中
$ cd [absolute path]
# 切换到指定相对路径目录中
$ cd [relative path]
# 切换到上一个位置目录中
$ cd -
# 切换到上一层目录中
$ cd ..
# 切换到上上一级目录中
$ cd ../..					
```
* **touch** 细节说明
```shell
# 同时创建多个文件
$ touch file1.txt file2.pdf
```
* **cp** 细节说明
```shell
# 相当于另存为
$ cp file1.txt file2.txt		
# 复制到当前目录的dir1文件夹下
$ cp file1.txt dir1
# 将dir1复制到dir2/dir3文件夹下(若没有dir2 dir3则创建)
$ cp -r dir1 dir2/dir3
```
* **mv** 细节说明
```shell
# 相当于重命名
$ mv file1.txt file2.txt
# 移动file1.txt到dir1文件夹中
$ mv file1.txt dir1
# 移动dir1文件夹到dir2/dir3文件夹下
$ mv dir1 dir2/dir3
```
* **rm** 细节说明
```shell
# 强制删除目录，目录非空时用到
$ rm -rf dir1				
# 删除当前目录下file1.txt文件
$ rm file1.txt
# 删除当前目录下dir1文件夹
$ rm -r dir1					
```
* **mkdir** 细节说明

```shell
mkdir -P dir1/dir2/dir3			# -P 表示递归创建
```

#### 2.2.3 通配符

通配符在大多数命令中均可使用

| 序号 | 通配符 | 含义 |
|:--------:|:-------:|:-------|
| 01 | * |匹配任意长度字符串，包含0|
| 02 | ? |匹配一个长度字符|
| 03 | [...] |匹配指定其中任意一个字符|
| 04 | [ - ] |匹配指定范围内的一个字符|
#### 2.2.4 文件操作

| 序号| 命令| 作用|
|:---: |:--------|:-------|
| 01 | cat[文件名] |查看文件内容、创建文件、文件合并、追加文件内容|
| 02 | head [文件名] | 显示文件头部(默认10行)|
| 03 | tail [文件名] | 显示文件头部(默认10行)|
| 04 | grep [搜索文本]+[文件名] | 搜索文本文件内容，仅适用于文件 |
| 05 | find[目录] -name [文件名] | 在一个目录及其子目录下查找文件|
| 06 | wc [文件名] | 查看文件行数，单词数等信息 |
| 07 | du [目录] | 递归查看文件夹大小 |
* **cat** 细节说明
```shell
cat file1.txt				# 打开file1.txt文件，显示所有文本信息
```
* **head** 细节说明
```shell
head file1.txt				# 默认查看文件前10行信息
head -5 file1.txt			# 查看文件前5行信息
```
* **find** 细节说明
```shell
find / -name ?.py			# 查看/(根)目录下一个名字的所有py文件s
```
* **grep** 细节说明
```shell
grep "a" file1.txt			# 显示包含"a"的file1.txt的所有文本信息
grep -i "a" file1.txt		# 显示包含"a"的file1.txt的所有文本信息，忽略大小写
grep -n "a" file1.txt		# 显示包含"a"的file1.txt的所有文本信息，显示行号
```
* **wc** 细节说明
```shell
wc file1.txt				# 分别显示file1.txt文件的行数、单词数、字符数
wc -l file1.txt				# 仅显示file1.txt文件的行数
wc -w file1.txt				# 仅显示file1.txt文件的单词数
wc -c file1.txt				# 仅显示file1.txt文件的字符数
```
* **du** 细节说明

```shell
du ~/Desktop				# 递归查看~/Desktop目录下文件大小
du -sh ～/Desktop		    # -s表示只显示大小总和 -h表示human，人类易读的格式显示 
```

* 管道
  管道可以把一系列命令连接起来，意味着一个命令的输出将作为第二个命令的的输入，通过管道传递给第二个命令，第二个命令的输出又作为第三个命令的输入，以此类推。

```shell
ls | grep 'hello'			# 在当前目录的所有文件中使用grep "hello" 命令
ls | wc -l					# 查看当前文件夹下子文件/夹数
```
#### 2.2.5 解压缩

| 序号| 命令| 作用|英文|
|:---: |:--------|:-------|:----|
| 01 | zip, unzip | 将文件压缩为zip格式/将zip格式文件解压|
| 02 | tar| 对gz或者bz2格式进行压缩解压 | **t**ape **ar**chive |
* **zip** 细节说明
```shell
zip file1.zip file1.txt		# 压缩文件
zip -r dir1.zip dir1		# 压缩文件夹
unzip dir1.zip				# 解压文件
unzip file1.zip ../			# 解压文件到指定文件夹
```
* **tar** 细节说明
```shell
tar -cjf dir1.tar.bz2 dir1	# 以bz2格式压缩文件，c：归档，j：bz2格式，f：指定文件名
tar -czf file1.tar.gz file1	# 以gz格式压缩文件，z：gz格式
tar -xvf file1.tar.gz		# 解压文件。可以是bz2可以是gz格式，x：表示解压，v：显示解压过程，f：指定压缩包名字
```
#### 2.2.6 权限管理
* 管理员权限和修改权限
| 序号 | 命令| 作用 | 英文 |
|:---:|:--------|:-------|:---|
|01| sudo | 放在一个命令前，表示使用管理员权限执行|**s**uper **u**ser **do** |
|02| chmod | 修改文件权限命令|**ch**ange **mod**e |
* **chmod**细节说明
```
chmod augo+[-][=]rwx file1.txt
a: 表示所有用户all
u: 表示当前用户user
g: 表示组成员group
o: 表示其它用户other
-: 表示取消某个或某几个权限
+: 表示增加某个或某几个权限
=: 表示重新设置权限
```
```shell
chmod u-w	file1.txt		# 为当前用户取消file1.txt的写权限
chmod u=rwx	file1.txt		# 为当前用户对file1.txt的权限改为可读可写和可执行权限
```
  * chmod快捷用法
```shell
# 4->r, 2->w,1->x
chmod 127 file1.txt			# 给自己设置执行权限，给小组成员设置写权限，为其他人设置写读可执行权限
```

#### 2.2.7 展示命令
| 序号 | 命令| 作用 |
|:---:|:--------|:-------|
|01| echo | 向终端打印内容 |
|02| date | 显示当前是时间 |
|03| df | 显示磁盘剩余空间 |
|04| whoami | 显示当前用户 |
|05| history [num] | 显示历史命令，默认500条 |

* **echo**细节说明

```shell
echo "hello"			# 向终端输出"hello"
echo -n "world"			# 表示输出完不换行
```

* **df**细节说明

```shell
df -Tf					# -T表示会显示分区类型，-h表示以M为容量单位
```

* **history**细节说明

```shell
history 				# 显示历史500条记录
history -10				# 显示历史10条记录
```

* 输出重定向

| 重定向类型 | 表示方式 | 注意                     |
| :--------: | :------- | :----------------------- |
|  新建模式  | >        | 若有同名文件则删除旧文件 |
|  追加模式  | >>       | 追加模式，不会删除旧文件 |

#### 2.2.8 其它命令
| 序号 | 命令     | 注意             |
| :--: | :------- | :--------------- |
|  01  | shutdown | 关机或重启       |
|  02  | ln       | 创建链接         |
|  03  | tree     | 获取树形目录结构 |

* **shutdown**细节说明

```shell
reboot					# 立即重启
shutdown now			# 立即关机
shutdown +10 			# 十分钟后关机
shutdown -c				# 取消关机计划
```

* **ln**细节说名

```shell
ln -s hello.py /home/blank/Desktop	# 一般使用 -s,表示创建软链接
```

## 3. Linux服务器环境

### 3.1 vim编辑器

* 语法

```shell
vim 1.py							# 编辑1.py,若不存在则创建
```

* 底行命令

| 序号 | 命令/快捷键        | 注意                         |
| :--: | :----------------- | :--------------------------- |
|  01  | shift z z          | 保存并退出                   |
|  02  | :w                 | 保存                         |
|  03  | :q                 | 退出不保存                   |
|  04  | :w!                | 强制保存                     |
|  05  | :q!                | 不保存并强制退出             |
|  06  | :数字              | 光标移动到数字对应的行       |
|  07  | :set nu            | 显示行号                     |
|  08  | :%s/str/replace/g  | 将所有str替换成replace       |
|  09  | :n,ms/str/repace/g | 指定n到m行的str替换成replace |

* 常用命令

| 序号 | 命令    | 注意                                               |
| :--: | :------ | :------------------------------------------------- |
|  01  | i       | 在当前光标处开始编辑                               |
|  02  | o       | 在当前光标所在行下一行插入一空行并开始编辑         |
|  03  | w       | 向后移动1单词                                      |
|  04  | b       | 向前移动1单词                                      |
|  05  | 0       | 光标移到行首                                       |
|  06  | \$      | 光标移到行尾                                       |
|  07  | gg      | 光标移到文件首                                     |
|  08  | G       | 光标移到文件尾                                     |
|  09  | u       | 撤销                                               |
|  10  | ctrl r  | 恢复撤销                                           |
|  11  | x       | 删除光标所在字符                                   |
|  12  | cc      | 删除光标所在行并进入插入模式                       |
|  13  | [num]yy | 复制num行                                          |
|  14  | [num]dd | 剪切num行                                          |
|  15  | p       | 粘贴                                               |
|  16  | r       | 替换当前光标所在字符                               |
|  17  | R       | 替换当前光标后的字符                               |
|  20  | /str    | 向下查找str，输入完成后按下回车，再按n继续向下查找 |

### 3.2 多用户管理

* 用户：Linux操作系统可以有不同的用户，这是系统管理的重要一环，不同的用户有自己独立的空间内容
* 用户组：为了方便对用户管理，Linux操作系统使用用户组的概念。将不同的用户添加到对应的组中，方便用户设置权限的设置
* root用户：Linux系统中的root用户通常用于系统的维护和管理，对操作系统的所有资源具有所有访问权限

用户创建删除流程

```shell
groupadd 新组名		 					# 添加组
user add -m 新用户名 -g 新组名				  # -m是创建新用户同时创建主目录，-g 新组名若不写则创建同用户名的组
passwd 新用户名						        # 不设置新用户密码则不能登陆
sudo vim /etc/sudoers
新用户名  ALL=(ALL:ALL) ALL			  		# 添加这一行，才能有sudo权限
sudo vim /etc/passwd
#sh ->bash							 	  # 检查新用户终端类型，修改成bash
userdel -r 用户名					   		# 彻底删除用户[可选]
groupdel 组名								# 删除对应的组[可选]
```

### 3.3 软件安装(ubantu)

| 作用                 | 命令                  |
| -------------------- | --------------------- |
| 更新软件源           | apt   update          |
| 安装软件             | apt   install         |
| 卸载软件             | apt   remove  --purge |
| 删除缓存的软件安装包 | apt   clean           |
| 安装本地软件包       | dpkg   -i             |
| 卸载软件             | dpkg  -P              |

* 注意事项 ： 安装软件包通常需要使用管理员权限。
* 软件包下载位置：/var/cache/apt/archives

### 3.4 ssh服务

#### 3.4.1 ArchLInux

* 安装`openssh`

```shell
$ sudo pacman -S openssh
```

* 设置开机自启（服务端）

```shell
$ sudo systemctl enable sshd
```

* 开启并检查服务

```shell
$ sudo systemctl start sshd
$ sudo systemctl status sshd
```

* 配置文件说明

```yacas
服务端配置目录：/ect/ssh/sshd_config
客户端配置目录：/ect/ssh/ssh_config
只允许特定用户访问，在服务端配置文件加入这一行：
AllowUsers  用户1 用户2
只允许特定组访问，在服务端配置文件加入这一行：
AllowGrops 组1 组2
设置登陆欢迎信息，在服务端配置文件加入这一行，可以自定义issue内容
Banner /etc/issue
```

* 连接服务端

```shell
$ ssh -p 22 gris@176.4.10.25
```

* 生成并提交公钥

```shell
$ ssh-keygen
$ ssh-copy-id gris@176.4.10.25
```

#### 3.4.2 Ubantu

ssh是一种安全协议，主要用于给远程登录会话数据进行加密，保证数据传输的安全。在数据传输方面有很多应用。之前说到，实际工作中经常需要远程访问服务器，ssh就是通用的远程访问服务器的方法。

```shell
# 安装启动
sudo apt install openssh-server
# 查看运行状态
sudo service ssh start/restart/stop
# 登录远程主机
ssh 用户名@ip
# 退出
exit
# 远程文件复制到本地
scp 用户名@ip:文件名(绝对路径) 目标位置
# 本地文件复制到远程
scp 目标位置 用户名@ip:远程位置(绝对路径)
```

* ssh 密钥

如果使用的客户端个人计算机是自己独有的计算机，经常通过ssh访问服务器，此时不想频繁输入密码，则可以使用秘钥处理。

```shell
# 在个人计算机生成.ssh文件夹，其中包括私钥文件id_rsa和公钥文件id_rsa.pub
$ ssh-keygen
# 在服务器主机上创建文件，将信任的计算机的id_rsa.pub内容追加到服务器的authorized_keys文件夹中
$ touch ~/.ssh/authorized_keys
```

* 终端启动Python服务

```shell
# 必须在py文件首行添加如下代码(解释器声明)
#!/usr/bin/python3
# 增加可执行权限
$ chmod 777 py文件名
# 通过文件名直接运行py文件
$py文件名
```
